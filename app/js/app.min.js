"use strict";document.addEventListener("DOMContentLoaded",(function(){(e=>{const t=document.querySelectorAll(e);if(t){t.forEach(e=>{const t=e.id;document.querySelectorAll("."+t).forEach(t=>{let r=e.querySelector(".close");t&&t.addEventListener("click",t=>{t.target&&t.preventDefault(),e.classList.add("active")}),r&&r.addEventListener("click",()=>{e.classList.remove("active")}),e.addEventListener("click",t=>{t.target===e&&e.classList.remove("active")})})})}})(".modal");(e=>{const t=document.querySelectorAll(e);let r=1,n=1,a=1,l=1;t.forEach(e=>{const t="form--"+r++;e.classList.add(t);let o=e.id=t,c=document.querySelector("#"+o);c.addEventListener("submit",(async function(t){t.preventDefault();let r=function(e){let t=0,r=c.querySelectorAll("._req");for(let e=0;e<r.length;e++){const n=r[e];n.classList.contains("_email")?m(n)&&(s(n),t++):"checkbox"===n.getAttribute("type")&&!1===n.checked?(d(n),t++):""===n.value&&(i(n),t++)}return t}(),n=new FormData(e);if(0===r){if(e.classList.add("_sending"),(await fetch("sendmail.php",{method:"POST",body:n})).ok){let t=document.querySelector("#modal__thanks");c.parentNode.style.display="none",t.classList.add("active"),e.reset(),e.classList.remove("_sending")}else alert("Ошибка при отправке"),e.classList.remove("_sending")}}));function i(e){let t=document.createElement("div");t.classList.add("form__error"),t.innerHTML="Введите данные в поле",e.parentElement.append(t),e.parentElement.classList.add("_error"),e.classList.add("_error")}function s(e){let t=document.createElement("div");t.classList.add("form__error"),t.innerHTML="Введите свою почту",e.parentElement.append(t),e.parentElement.classList.add("_error"),e.classList.add("_error")}function d(e){let t=document.createElement("div");t.classList.add("form__error"),t.innerHTML="Согласие на обработку персональных данных",e.parentElement.append(t),e.parentElement.classList.add("_error"),e.classList.add("_error")}function m(e){return!/^([a-z0-9_-]+\.)*[a-z0-9_-]+@[a-z0-9_-]+(\.[a-z0-9_-]+)*\.[a-z]{2,6}$/.test(e.value)}c.querySelectorAll(".formImgFile").forEach(e=>{const t="formImgFile--"+r++;let o=e.id=t,c=document.querySelector("#"+o);const i=c.querySelector(".formImage"),s=c.querySelector(".formLebel"),d=c.querySelector(".formPreview");let m="formImage--"+n++,u="formPreview--"+l++;i.id=m,s.htmlFor="formImage--"+a++,d.id=u;document.querySelector("#"+m).addEventListener("change",()=>{!function(e){if(!["image/jpeg","image/png","image/gif","image/ico","application/pdf"].includes(e.type))return alert("Только изображения"),void(i.value="");if(e.size>2097152)return void alert("Размер менее 2 мб.");var t=new FileReader;t.onload=function(t){["application/pdf"].includes(e.type)?d.innerHTML="Файл выбран":d.innerHTML=`<img src="${t.target.result}" alt="Фото">`},t.onerror=function(e){alert("Ошибка")},t.readAsDataURL(e)}(i.files[0])})})})})(".form")}));